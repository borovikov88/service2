{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>{% block title %}–°–µ—Ä–≤–∏—Å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –±–∞—Å—Å–µ–π–Ω–æ–≤{% endblock %}</title>

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="{% static 'assets/images/favicon.ico' %}" />

  <!-- Bootstrap icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- Main CSS -->
  <link href="{% static 'assets/css/style.css' %}" rel="stylesheet" />
</head>

<body>

<!-- ======== MOBILE TOP PANEL ======== -->
<div class="mobile-app-bar">

    <!-- –ú–µ–Ω—é -->
    <button class="appbar-btn menu-btn" onclick="openMenu()">‚ò∞</button>

    <!-- –õ–æ–≥–æ—Ç–∏–ø -->
    <img src="{% static 'pool_service/img/logo.png' %}" class="app-logo">

    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
    <div class="app-title">
        {{ page_title|default:"–ü–∞–Ω–µ–ª—å" }}
    </div>

    <!-- –ü–æ–∏—Å–∫ -->
    {% if show_search %}
        <button class="appbar-btn search-btn">üîç</button>
    {% endif %}

    <!-- –î–æ–±–∞–≤–∏—Ç—å -->
    {% if show_add_button and add_url %}
        <a href="{{ add_url }}" class="appbar-btn add-btn">Ôºã</a>
    {% endif %}

</div>
<!-- ======== END MOBILE TOP PANEL ======== -->


<!-- ======== DESKTOP NAVBAR ======== -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark desktop-navbar">
    <div class="container px-lg-5">
        <a class="navbar-brand" href="/">–°–µ—Ä–≤–∏—Å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –±–∞—Å—Å–µ–π–Ω–æ–≤</a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
                data-bs-target="#navbarSupportedContent">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">

                <li class="nav-item"><a class="nav-link active" href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="nav-item"><a class="nav-link" href="/pools">–°–ø–∏—Å–æ–∫ –±–∞—Å—Å–µ–π–Ω–æ–≤</a></li>

                {% if user.is_authenticated %}
                    <li class="nav-item">
                        <p class="nav-link">
                            {% if user.first_name or user.last_name %}
                                {{ user.first_name }} {{ user.last_name }}
                            {% else %}
                                {{ user.username }}
                            {% endif %}
                        </p>
                    </li>

                    <li class="nav-item">
                        <form method="post" action="{% url 'logout' %}">
                            {% csrf_token %}
                            <button class="btn btn-outline-primary btn-lg" type="submit">–í—ã–π—Ç–∏</button>
                        </form>
                    </li>

                {% else %}
                    <li class="nav-item">
                        <a class="btn btn-primary btn-lg" href="{% url 'login' %}">–í–æ–π—Ç–∏</a>
                    </li>
                {% endif %}

            </ul>
        </div>
    </div>
</nav>
<!-- ======== END DESKTOP NAVBAR ======== -->


<main>
    {% block content %}{% endblock %}
</main>

<footer class="py-5 bg-dark desktop-navbar">
    <div class="container">
        <p class="m-0 text-center text-white">
            Copyright ¬© –°–µ—Ä–≤–∏—Å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –±–∞—Å—Å–µ–π–Ω–æ–≤ 2025
        </p>
    </div>
</footer>


<!-- ======== MOBILE SIDEBAR MENU (DRAWER) ======== -->
<div id="menu-overlay" class="menu-overlay" onclick="closeMenu()"></div>

<div id="mobile-menu" class="mobile-menu">
    
    <div class="menu-header">
    <button class="close-btn" onclick="closeMenu()">‚úï</button>

    <img src="{% static 'pool_service/img/logo.png' %}" class="drawer-logo">
    <span class="drawer-title">–°–µ—Ä–≤–∏—Å –±–∞—Å—Å–µ–π–Ω–æ–≤</span>
</div>


    <div class="menu-content">
        <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="{% url 'profile' %}">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
        <a href="/pools">–°–ø–∏—Å–æ–∫ –±–∞—Å—Å–µ–π–Ω–æ–≤</a>
        <a href="/readings/all">–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π</a>


        {% if user.is_authenticated %}
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button class="logout-btn">–í—ã–π—Ç–∏</button>
            </form>
        {% endif %}
    </div>

</div>


<!-- Working Drawer JS -->
<script>
function openMenu() {
    document.getElementById("mobile-menu").classList.add("open");
    document.getElementById("menu-overlay").classList.add("show");
}

function closeMenu() {
    document.getElementById("mobile-menu").classList.remove("open");
    document.getElementById("menu-overlay").classList.remove("show");
}
</script>
<script>
// === Swipe to close ===
let touchStartX = 0;

document.addEventListener('touchstart', function(e) {
    touchStartX = e.changedTouches[0].clientX;
}, false);

document.addEventListener('touchend', function(e) {
    let touchEndX = e.changedTouches[0].clientX;

    // –ï—Å–ª–∏ –ø—Ä–æ–≤–µ–ª–∏ –ø–∞–ª—å—Ü–µ–º –≤–ª–µ–≤–æ –Ω–∞ > 50px
    if (document.getElementById("mobile-menu").classList.contains("open")) {
        if (touchStartX - touchEndX > 50) {
            closeMenu();
        }
    }
}, false);
</script>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'assets/js/scripts.js' %}"></script>
<!-- ======== MOBILE BOTTOM NAVIGATION ======== -->
<div class="mobile-bottom-nav">
    <a href="/pools" class="bottom-item {% if active_tab == 'pools' %}active{% endif %}">
        <i class="bi bi-list-ul bottom-icon"></i>
        <span>–ë–∞—Å—Å–µ–π–Ω—ã</span>
    </a>

    <a href="/readings/all" class="bottom-item {% if active_tab == 'readings' %}active{% endif %}">
        <i class="bi bi-droplet bottom-icon"></i>
        <span>–ü–æ–∫–∞–∑–∞–Ω–∏—è</span>
    </a>

    <a href="{% url 'profile' %}" class="bottom-item {% if active_tab == 'profile' %}active{% endif %}">
        <i class="bi bi-person-circle bottom-icon"></i>
        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
    </a>
</div>

</body>
</html>
